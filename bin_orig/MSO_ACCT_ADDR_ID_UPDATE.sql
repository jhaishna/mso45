CREATE OR REPLACE
PROCEDURE MSO_ACCT_ADDR_ID_UPDATE AS
CURSOR ACCT_CURSOR IS SELECT T1.ACCOUNT_NO, T2.FIRST_NAME, T2.MIDDLE_NAME, T2.LAST_NAME, T3.LOGIN, T1.RMAIL, T2.ADDRESS, 
     T1.RMN, SUBSTR(T3.PASSWD,5) PASSWORD, T4.LOCATION_NAME, 
    T4.AREA_NAME, T4.STREET_NAME, T4.BUILDING_NAME, T4.LANDMARK
    FROM ACCOUNT_T T1, ACCOUNT_NAMEINFO_T T2, MSO_CUSTOMER_CREDENTIAL_T T3, MSO_ACCOUNT_NAMEINFO_T T4, 
    PROFILE_T T5, PROFILE_CUSTOMER_CARE_T T6    
    WHERE T1.POID_ID0 = T2.OBJ_ID0 AND T2.REC_ID = 1 AND T4.REC_ID = 1
    AND T1.POID_ID0 = T3.ACCOUNT_OBJ_ID0 AND T1.POID_ID0 = T4.OBJ_ID0(+)
    AND T5.ACCOUNT_OBJ_ID0 = T1.POID_ID0 AND T5.POID_ID0 = T6.OBJ_ID0
    AND T1.AAC_VENDOR = 'UPASS';
    
CURSOR ADDR_CURSOR IS  SELECT T1.ACCOUNT_NO, T3.AREA_NAME, T3.LOCATION_NAME, T3.STREET_NAME, T3.BUILDING_NAME, T3.LANDMARK
    FROM ACCOUNT_T T1, ACCOUNT_NAMEINFO_T T2, MSO_ACCOUNT_NAMEINFO_T T3
    WHERE T1.POID_ID0 = T2.OBJ_ID0 AND T2.REC_ID = 2 AND T3.REC_ID = 2
    AND T1.POID_ID0 = T3.OBJ_ID0 (+)
    AND T1.AAC_VENDOR = 'UPASS';
ACCT_REC ACCT_CURSOR%ROWTYPE;
ADDR_REC ADDR_CURSOR%ROWTYPE;

BEGIN
  FOR ACCT_REC IN ACCT_CURSOR LOOP
      UPDATE OAP.OAP_USER_DETAILS_T SET AREA = ADDR_REC.AREA_NAME, LOCATION = ADDR_REC.LOCATION_NAME, STREET = ADDR_REC.STREET_NAME,
        BUILDING = ADDR_REC.BUILDING_NAME, LANDMARK = ADDR_REC.LANDMARK
        WHERE USER_ID = ACCT_REC.ACCOUNT_NO AND REC_ID = 2;
  END LOOP;

  FOR ACCT_REC IN ACCT_CURSOR LOOP
      UPDATE OAP.OAP_USER_MASTER_T SET 
        FIRST_NAME = ACCT_REC.FIRST_NAME, MIDDLENAME = ACCT_REC.MIDDLE_NAME, LAST_NAME = ACCT_REC.LAST_NAME, EMAIL_ID = ACCT_REC.RMAIL, 
        ADDRESS_1 = ACCT_REC.ADDRESS, MOBILE_NUMBER =ACCT_REC.RMN, PASSWORD = ACCT_REC.PASSWORD, LOCATION_1 = ACCT_REC.LOCATION_NAME, 
        AREA_1 = ACCT_REC.AREA_NAME, STREET_1 = ACCT_REC.STREET_NAME, BUILDING_1 =ACCT_REC.BUILDING_NAME, LANDMARK_1=ACCT_REC.LANDMARK
        WHERE USER_ID = ACCT_REC.ACCOUNT_NO ;

      UPDATE OAP.OAP_USER_DETAILS_T SET AREA = ACCT_REC.AREA_NAME, LOCATION = ACCT_REC.LOCATION_NAME, STREET = ACCT_REC.STREET_NAME,
        BUILDING = ACCT_REC.BUILDING_NAME, LANDMARK = ACCT_REC.LANDMARK
        WHERE USER_ID = ACCT_REC.ACCOUNT_NO AND REC_ID = 1;

      UPDATE ACCOUNT_T SET AAC_VENDOR='' WHERE ACCOUNT_NO = ACCT_REC.ACCOUNT_NO;

  END LOOP;
COMMIT;
END MSO_ACCT_ADDR_ID_UPDATE;
/

